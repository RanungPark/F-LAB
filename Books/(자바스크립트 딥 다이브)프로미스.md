## 프로미스

### 왜 탄생하였는가?

- 자바스크립트의 비동기 처리를 위해서는 콜백 함수가 사용되었는데 콜백 함수는 콜백 헬로 이어질 수 있고, 가독성이 나쁘다.
- 또한 비동기 동작 중에 발생하는 에러 처리가 곤란하며 한번에 여러 개의 비동기 처리하는데에도 한계가 있다.

### **왜 이렇게 동작하는가?**

- 자바스크립트는 싱글 스레드로 동기로 동작한다
- 비동기 함수는 자바스크립트 엔진이 아닌 브라우저에서 동작한다
- 비동기 함수의 콜백 함수는 태스크 큐에서 대기하였다가 콜 스택이 모두 비워졌을 때 대기중이던 콜백 함수를 콜 스택으로 이벤트 루프가 이동시켜 실행한다.
- 이때문에 콜백 함수가 평가되는 시기는 콜 스택이 비워진 상태임으로 비동기 함수의 비동기 처리 결과를 외부에 반환할 수 없고, 상위 스코프의 변수에 할당 할 수 없다.
- 이는 비동기 함수 내부에서 비동기 함수를 처리하는 후속 처리 결과를 비동기 함수 내부에서 진행해야한다.
- 때문에 비동기 함수를 작성할 때는 가독성이 좋지 않은 콜백 헬로 이어지게 되는것이다.
- 또한 에러가 발생하여도 에러전파는 호출자 방향으로 전파되며 콜백 함수의 에러를 catch해낼 수 없다.
- 이러한 콜백 패턴이 가진 단점을 보완하여 비동기 처리 시점을 명확하게 표현하고자 탄생하였다.

### 프로미스는 무엇인가?

- 비동기 처리 상태와 결과를 관리하는 객체이다.
  - 기본 상태는 pending으로 비동기 처리가 아직 수행 되지 않은 상태이다.
  - 비동기 처리를 성공한다면 resolve함수를 호출하여 프로미스의 상태는 fulfilled가 된다.
  - 비동기 처리를 실패하다면 reject함수를 호출하여 프로미스의 상태는 rejected가 된다.
- 비동기 처리 상태가 변화하면 후속 처리 메서드에 인수로 전달한 콜백 함수가 선택적으로 호출된다.

### 프로미스의 메서드

- Promise.all: 여러개의 비동기 처리를 모두 병렬 처리할 때 사용한다.
- Promise.race: 여러개의 비동기 처리중 가장 먼저 fulfilled 상태가 된 프로미스의 처리 결과를 resolve하는 새로운 프로미스를 반환한다.
