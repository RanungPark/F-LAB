### Stateful

**Stateful(상태 유지)**

서버가 클라이언트의 상태를 보존한다.

서버에서 클라이언트가 이전 단계에서 제공한 값을 저장하고 다음 단계에서도 저장한 상태이다.

이러한 정보는 브라우저의 쿠키에 저장되거나 서버의 세션 메모리에 ㅈ장되어 상태를 유지하게 된다.

**프로토콜**

대표적인 Stateful 프로토콜 TCP의 3-way handshaking

<img src="https://github.com/RanungPark/F-LAB/assets/104816866/ad468f17-d44b-4ff6-aec0-e01deda459d7"  width="500" height="400"/>

1. 클라이언트가 서버에 접속 요청을 하는 SYN 패킷을 보내면서 SYN/ACK 응답을 기다리는 클라이언트는 SYN-SENT 상태가 된다.
2. 서버가 SYN요청을 받고 클라이언트에게 요청을 수락한다는 ACK와 SYN flag가 설정된 패킷을 보내면서 클라이언트가 ACK를 보내기를 기다리며 서버는 SYN-RECVED 상태가 된다.
3. 클라이언트는 서버에게 ACK를 보내고 서버가 ESTABLESHED 상태가 되면 데이터를 주고 받을 수 있는 상태가 된다.

**상태 유지의 문제점**

연결된 서버가 멈추거다 다양한 이유로 연결된 서버를 못쓰게 되어 다른 서버를 사용해야 할 때 다시 같은 기능을 하는 새로운 서버에 다시 연결을 하여야 한다. 그렇지 않으면 서버는 클라이언트의 상태를 알 수 없다.

이를 해결하기 위해 캐시 서버를 이용한다. 

### Stateless

**Stateless(무상태)**

서버가 클라이언트의 상태를 보존하지 않고 상태 관리를 클라이언트에게 책임을 넘기는 것이다.

통신에 필요한 모든 상태 정보들은 클라이언트에서 가지고 있다가 서버와 통신할때 데이터를 실어 보내는 것이 무상태 구조이다.

따라서 대량의 트래픽이 발생하였을 때 서버를 확장하면서 대처를 수월하게 할 수 있다.(스케일 아웃에 유리하다)

**프로토콜**

대표적인 Stateless 프로토콜은 UDP와 HTTP이다.

HTTP의 경우 무상태인데 무상태에 경우 브라우저는 데이터를 전송할 때마다 연결을 바로 끊어 버리게 된다.

UDP는 handshaking 과정을 수행하지 않고 보낸다.

**문제점**

클라이언트는 더 많은 데이터가 소모된단.

매 요청마다 정보를 줘야한다.

**토큰**

로그인과 같은 상태를 Stateful일 때 효과적인 상황에서 Stateless를 하고싶다면 토큰을 통해 상태를 유지할 수 있다.

토큰은 클라이언트가 암호화된 로그인 정보를 지니고 있다가 서버에 통신할 때 넘겨주어 인증되는 방식이다. 

**번외(스케일 업/ 스케일 아웃)**

스케일 업은 기존 서버의 사양을 업그레이드해 시스템을 확장하는 것을 말한다.(수직 스케일로 불리기도 한다.)

스케일 아웃은 서버를 여러대 추가하여 시스템을 확장하는 것을 말한다.

(수평 스케일로 불리기도 한다.)

![image](https://github.com/RanungPark/F-LAB/assets/104816866/8325831b-4ef5-4a0c-940b-505029426e7a)